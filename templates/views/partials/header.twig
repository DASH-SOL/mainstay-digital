<header class="site-header">
    <div class="header-container">
        <div class="header-left">
            <div class="logo-container">
                <a href="{{ site.url }}" class="flex items-center">
                    {% if custom_logo %}
                        <img src="{{ custom_logo.url }}" 
                             alt="{{ custom_logo.alt }}" 
                             class="custom-logo"
                             style="width: {{ logo_settings.width }}px; height: {{ logo_settings.height }}px; object-fit: contain;">
                    {% else %}
                        <span class="logo-slashes">///</span>
                        <span class="logo-text">MAINSTAY</span>
                    {% endif %}
                </a>
            </div>
        </div>

        <div class="header-center">
            {% if primary_menu and primary_menu.items %}
                <nav class="main-navigation" role="navigation">
                    {% for item in primary_menu.items %}
                        {% if item.children %}
                            <div class="nav-menu-item has-children" data-menu="{{ loop.index }}">
                                <span>{{ item.title }}</span>
                            </div>
                        {% else %}
                            <a href="{{ item.url }}" class="nav-menu-item">
                                {{ item.title }}
                            </a>
                        {% endif %}
                    {% endfor %}
                    
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            {% for item in primary_menu.items %}
                                {% if item.children %}
                                    <div class="mega-menu-content" data-content="{{ loop.index }}" style="display: none; grid-template-columns: minmax(300px, 1fr) 2fr; gap: 2rem;">
                                        <div class="mega-menu-left">
                                            <h2 class="mega-menu-title">{{ item.title }}</h2>
                                        </div>
                                        
                                        <div class="mega-menu-right">
                                            <div class="mega-menu-children">
                                                {% for child in item.children %}
                                                    <div class="mega-menu-child-item">
                                                        <a href="{{ child.url }}" class="mega-menu-child-link">
                                                            {{ child.title }}
                                                        </a>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </nav>
            {% endif %}
        </div>

        <div class="header-right">
            <div class="cta-button-container">
                <a href="/contact" class="btn-mainstay">
                    Get in touch
                </a>
            </div>

            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <svg class="hamburger-icon" width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect y="0.647705" width="14.909" height="2.43833" fill="black"/>
                    <rect y="15.2777" width="14.909" height="2.43833" fill="black"/>
                    <rect y="7.96268" width="14.909" height="2.43833" fill="black"/>
                </svg>
                <svg class="close-icon hidden" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.71701 1.68872L21.164 21.1505" stroke="#185D74" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21.164 1.68872L1.71701 21.1505" stroke="#185D74" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    </div>

    <div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>

    <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-header">
            <div class="logo-container">
                {% if custom_logo %}
                    <img src="{{ custom_logo.url }}" 
                         alt="{{ custom_logo.alt }}" 
                         class="custom-logo mobile-logo"
                         style="width: {{ logo_settings.width * 0.8 }}px; height: {{ logo_settings.height * 0.8 }}px; object-fit: contain;">
                {% else %}
                    <span class="logo-slashes">///</span>
                    <span class="logo-text">MAINSTAY</span>
                {% endif %}
            </div>
            <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Close mobile menu">
                <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.71701 1.68872L21.164 21.1505" stroke="#185D74" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21.164 1.68872L1.71701 21.1505" stroke="#185D74" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>

        {% if primary_menu and primary_menu.items %}
            <nav class="mobile-menu-nav">
                {% for item in primary_menu.items %}
                    <div class="mobile-menu-item-wrapper">
                        {% if item.children %}
                            <div class="mobile-nav-item mobile-nav-main-item mobile-accordion-trigger" data-accordion="{{ loop.index }}">
                                <span class="font-rubik font-medium text-[32px] leading-none text-gray-900">{{ item.title }}</span>
                                <svg class="w-[23px] h-[14px] flex-shrink-0 accordion-arrow transition-transform duration-300" viewBox="0 0 23 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.81201 12.3778L11.441 1.29639L21.07 12.3778" stroke="black" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>

                            <div class="mobile-accordion-content" data-content="{{ loop.index }}">
                                <a href="{{ item.url }}" class="mobile-nav-parent-link">
                                    <div class="flex items-center">
                                        <span class="font-rubik font-normal text-[17px] leading-none text-gray-900">Go to {{ item.title|lower }}</span>
                                    </div>
                                    <svg class="w-[9px] h-[14px] flex-shrink-0" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0.779999 0.939697L7.45599 6.74412L0.779999 12.5485" stroke="black" stroke-width="1.542" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </a>

                                {% for child in item.children %}
                                    {% if child.children %}
                                        <div class="mobile-nav-child-accordion">
                                            <div class="mobile-nav-item mobile-accordion-trigger" data-accordion="{{ loop.parent.loop.index }}-{{ loop.index }}">
                                                <span class="font-rubik font-normal text-[17px] leading-none text-gray-900">{{ child.title }}</span>
                                                <svg class="w-[23px] h-[14px] flex-shrink-0 accordion-arrow transition-transform duration-300" viewBox="0 0 23 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M1.81201 12.3778L11.441 1.29639L21.07 12.3778" stroke="black" stroke-width="2.558" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                            </div>
                                            
                                            <div class="mobile-accordion-content pl-6" data-content="{{ loop.parent.loop.index }}-{{ loop.index }}">
                                                <a href="{{ child.url }}" class="mobile-nav-parent-link">
                                                    <div class="flex items-center">
                                                        <span class="font-rubik font-normal text-[17px] leading-none text-gray-900">Go to {{ child.title|lower }}</span>
                                                    </div>
                                                    <svg class="w-[9px] h-[14px] flex-shrink-0" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M0.779999 0.939697L7.45599 6.74412L0.779999 12.5485" stroke="black" stroke-width="1.542" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </a>
                                                
                                                {% for grandchild in child.children %}
                                                    <a href="{{ grandchild.url }}" class="mobile-nav-item">
                                                        <span class="font-rubik font-normal text-[17px] leading-none text-gray-900">{{ grandchild.title }}</span>
                                                        <svg class="w-[9px] h-[14px] flex-shrink-0" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <path d="M0.779999 0.939697L7.45599 6.74412L0.779999 12.5485" stroke="black" stroke-width="1.542" stroke-linecap="round" stroke-linejoin="round"/>
                                                        </svg>
                                                    </a>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    {% else %}
                                        <a href="{{ child.url }}" class="mobile-nav-item">
                                            <span class="font-rubik font-normal text-[17px] leading-none text-gray-900">{{ child.title }}</span>
                                            <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M14.0751 3.83902L10.3664 7.54773V4.47431H0.304871V3.20374H10.3664V0.13032L14.0751 3.83902Z" fill="#0EDD7A"/>
                                            </svg>
                                        </a>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% else %}
                            <a href="{{ item.url }}" class="mobile-nav-item mobile-nav-main-item">
                                <span class="font-rubik font-medium text-[32px] leading-none text-gray-900">{{ item.title }}</span>
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            </nav>
        {% endif %}

        <div class="mobile-cta">
            <a href="/contact" class="mobile-cta-button">
                Get in touch
            </a>
        </div>
    </div>
</header>